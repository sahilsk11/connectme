<!DOCTYPE html>
<html>
	<head>
		<title>Connect</title>
		<meta name = "viewport" content="initial-scale=1.0">
		<meta name="author" content="Sahil Kapur">

		<link href="../CSS/organize.css" rel="stylesheet">
		<link href="../CSS/bootstrap.css" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Questrial|Raleway" rel="stylesheet">
		<script src="../js/XHRequest.js"></script>
		<script src="../js/jquery-2.2.4.min.js"></script>
		<script src="../js/bootstrap.js"></script>
		<script>
			var code;

			function getCode() {
				var url = new URL(window.location.href);
				code = url.searchParams.get("code");
			}

			function getEvent() {
				XHRequest.createRequest({
					success: displayEvent, 
					method: "GET",
					params: {
						command: "single_event",
						code: code
					},
					url: "../scripts/connect_database.py"
				});
			}

			function displayEvent(xhr, xhrConfig) {
				var events = JSON.parse(xhr.responseText);
				var name = events["name"];
				var date = events["group_date"];
				var host = events["host"];
				var host_id = events["host_id"];
				var code = events["uid"];
				var categories = events["categories"];
				var description = events["description"];
				var location = events["location"];
				var maximum_people = events["maximum_people"];
				var facebook_link = events["fb_url"];
				document.getElementById("name").innerHTML = name;
				document.getElementById("date").innerHTML = date;
				document.getElementById("description").innerHTML = description;

				document.getElementById("map").src = "//www.google.com/maps/embed/v1/place?q="+location+"&zoom=17&key=AIzaSyBeEZCy4cxgcCAh17K7RswTSI6wEjaMweE";
				document.getElementById("host-name").innerHTML = host["name"];
				document.getElementById("host-name").href = "../newaccount?code="+host_id;
				document.getElementById("host-email").innerHTML = host["email"];
				document.getElementById("host-phone").innerHTML = host["phone"];
			}

			function apply() {
				document.getElementById("form").hidden = false;

			}

			function run() {
				getCode();
				getEvent();
			}

		</script>
	</head>

	<body onload="run()">
		<nav class="navbar-inverse">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
			      		<span class="sr-only">Toggle navigation</span>
			      		<span class="icon-bar"></span>
			      		<span class="icon-bar"></span>
			      		<span class="icon-bar"></span>
		        	</button>
	    			<a href="../" class="navbar-brand">
	    				<p class="title-font">ConnectMe</p>
	    				<img src="" class="">
	    			</a>
				</div>
	    		<div id="navbar" class="navbar-collapse collapse">
	    			<ul class="nav navbar-nav theme">
	    				<li><a href="../user">Profile</a></li>
	    				<li><a href="../create">Create Event</a></li>
	    				<li><a href="../newaccount">Create Account</a></li>
	    				<li><a href="../verify">Verify Club</a></li>
	    			</ul>
	    		</div>
	 		</div>
		</nav>

		<h1 class="title-font text-center" id="name"></h1>
		<h5 class="title-font text-center" id="date"></h5>

		<p class="lead description-field center" id="description"></p>

		<iframe width="100%" height="300px" id="map"></iframe>

		<h1 class="title-font text-center">Host Information</h1>
		<div class="title-font container-fluid">
			<h3 id="host-name"></h3>
			<h3 id="host-email"></h3>
			<h3 id="host-phone"></h3>
		</div>

		<button class="btn btn-primary" onclick="apply()">Apply for Event</button>

		<div id="form" hidden="true">
			
		</div>

	</body>
</html>